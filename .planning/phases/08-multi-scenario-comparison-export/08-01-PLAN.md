---
phase: 08-multi-scenario-comparison-export
plan: 01
type: execute
---

<objective>
Enable chart export functionality with download button using recharts-to-png library.

Purpose: Allow users to save comparison charts as PNG images for presentations and reports.
Output: Export button that downloads chart as `aws-{service}-comparison.png`
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-phase.md
./summary.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-multi-scenario-comparison-export/DISCOVERY.md
@.planning/codebase/STRUCTURE.md
@.planning/codebase/CONVENTIONS.md
@src/components/ComparisonChart.tsx
@src/components/ComparisonLayout.tsx
@src/types/comparison.ts

**Tech stack available:**
- Recharts 3.3.0 (already installed)
- Framer Motion 12.25.0 for animations
- Tailwind CSS with Material Design theme
- TypeScript strict mode

**Established patterns:**
- Component-driven with local useState
- PascalCase for components, camelCase for utilities
- Inline className with Tailwind utilities
- dark: variants for theme-aware styling
- Framer Motion variants for animations

**Key decisions from Phase 7:**
- Dark mode uses .dark class with ThemeContext
- All components support theme switching
- Chart colors theme-independent where possible

**Issues being addressed:**
- Users cannot save comparison charts for offline use or presentations
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install chart export dependencies</name>
  <files>package.json, package-lock.json</files>
  <action>Install recharts-to-png@3.0.1 and file-saver with TypeScript types. Use npm install recharts-to-png file-saver @types/file-saver. Verify compatibility with existing Recharts 3.3.0 (recharts-to-png v3.x is compatible).</action>
  <verify>npm list recharts-to-png file-saver shows both packages installed</verify>
  <done>Dependencies added to package.json and node_modules installed</done>
</task>

<task type="auto">
  <name>Task 2: Add chart export functionality to ComparisonChart</name>
  <files>src/components/ComparisonChart.tsx</files>
  <action>Import useCurrentPng from 'recharts-to-png' and FileSaver. Add useCurrentPng hook to get getPng function and ref. Attach ref to ResponsiveContainer (not BarChart - ResponsiveContainer is the parent that needs capturing). Create handleDownload function that calls getPng(), gets PNG data URL, and uses FileSaver.saveAs(png, 'aws-comparison.png'). Add "Download Chart" button below chart with download icon (â†“), primary styling, disabled state when isLoading, and onClick={handleDownload}. Use motion.button with buttonVariants for animation. Position button at bottom-right using flex layout.</action>
  <verify>npm run build succeeds, no TypeScript errors in ComparisonChart.tsx</verify>
  <done>Export button renders below chart, clicking downloads PNG image</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Chart export functionality with download button</what-built>
  <how-to-verify>
    1. Run: npm run dev (if not running)
    2. Visit: http://localhost:5173 (or current dev server URL)
    3. Navigate to any service comparison page (S3, Aurora, Lambda, or ECS)
    4. Look for "Download Chart" button below the comparison chart
    5. Click the button - should download a PNG file named "aws-comparison.png"
    6. Open downloaded PNG - verify chart is clearly visible with all bars, labels, and legend
    7. Test in both light and dark themes - both exports should have readable charts
    8. Verify button shows "Downloading..." while processing
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] Export button visible on all service comparison pages
- [ ] Clicking export downloads valid PNG file
- [ ] Exported chart is readable in both light and dark themes
- [ ] No console errors when downloading
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Export functionality works on all service pages
- No errors or warnings introduced
- Downloaded chart images are high quality and readable
</success_criteria>

<output>
After completion, create `.planning/phases/08-multi-scenario-comparison-export/08-01-SUMMARY.md`:

# Phase 8 Plan 1: Chart Export Functionality Summary

**[Substantive one-liner - what shipped, not "phase complete"]**

## Accomplishments

- Installed recharts-to-png and file-saver dependencies
- Integrated chart export with download button
- Export works across all service comparison pages
- Theme-independent chart exports

## Files Created/Modified

- `package.json` - Added recharts-to-png, file-saver, @types/file-saver
- `src/components/ComparisonChart.tsx` - Added export functionality with useCurrentPng hook

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 08-02-PLAN.md (Multi-Scenario State Management)
</output>
