---
phase: 06-ecs-service-integration
plan: 01
type: execute
---

<objective>
Add ECS service with Fargate pricing, vCPU/memory configurations, and architecture comparison (x86 vs ARM Graviton2).

Purpose: Enable users to compare ECS Fargate costs between x86 and ARM architectures with different vCPU/memory configurations, following the established service integration pattern from Lambda.
Output: Fully functional ECS service with type-safe cost calculations, animated form controls, and generic comparison framework integration.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-phase.md
@./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-lambda-service-integration/05-01-SUMMARY.md
@src/types/lambda.ts
@src/utils/lambdaCalculator.ts
@src/components/LambdaConfigForm.tsx
@src/components/LambdaComparison.tsx
@src/App.tsx

**Tech stack available:**
- React 18.3.1 with TypeScript
- Framer Motion 12.25.0 for animations
- Tailwind CSS 4.1.16 with Material Design theme
- Generic comparison framework with TypeScript generics

**Established patterns:**
- Service type definitions in src/types/{service}.ts with metadata constants
- Cost calculators in src/utils/{service}Calculator.ts with adapter functions
- Config forms in src/components/{Service}ConfigForm.tsx with animated controls
- Comparison pages in src/components/{Service}Comparison.tsx using ComparisonLayout
- Service registration in both App.tsx routes and LandingPage.tsx cards

**Constraining decisions:**
- Phase 5: Lambda integration established the pattern for serverless service comparison
- Phase 2: All forms use interactiveControlVariants for unified interaction feedback
- Phase 1: Cost-specific semantic colors (savings=green, increase=red) applied to cheaper option
- Phase 1: Framer Motion variants approach for reusable animations

**ECS Fargate Pricing (EU Ireland region):**
- x86: $0.04048 per vCPU-hour, $0.004445 per GB-hour
- ARM Graviton2: $0.03238 per vCPU-hour (~20% cheaper), $0.003556 per GB-hour (~20% cheaper)
- Valid vCPU/memory combinations: 0.25-16 vCPU with 512 MB-120 GB memory (constrained by vCPU)
- Billing: Per-second granularity, rounded up
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ECS type definitions with Fargate configuration metadata</name>
  <files>src/types/ecs.ts</files>
  <action>
Create ECS type definitions following Lambda pattern:
- EcsArchitecture type: 'x86' | 'arm' (Graviton2)
- EcsConfig interface: architecture, vCPU (number), memoryGB (number), monthlyHours (number)
- EcsCostBreakdown interface: cpuCost, memoryCost, totalCost
- ECS_ARCHITECTURE_METADATA constant with pricing per vCPU-hour and per GB-hour for each architecture
- ECS_VCPU_TIERS array with common configurations (0.25, 0.5, 1, 2, 4, 8 vCPU) and descriptions
- ECS_MEMORY_RANGES constant documenting memory limits per vCPU tier (e.g., 0.25 vCPU: 512MB-2GB)

Use EU (Ireland) pricing: x86 = $0.04048/vCPU-hr + $0.004445/GB-hr, ARM = $0.03238/vCPU-hr + $0.003556/GB-hr.
Follow Lambda's type structure - simple, focused on cost calculation inputs/outputs.
  </action>
  <verify>TypeScript compilation succeeds, types export correctly</verify>
  <done>ECS types defined with metadata, no TypeScript errors</done>
</task>

<task type="auto">
  <name>Task 2: Create ECS cost calculator with vCPU and memory pricing</name>
  <files>src/utils/ecsCalculator.ts</files>
  <action>
Implement cost calculator following Lambda pattern:
- calculateEcsCosts(config: EcsConfig): EcsCostBreakdown
  - Calculate cpuCost = vCPU * pricePerVCPUHour * monthlyHours
  - Calculate memoryCost = memoryGB * pricePerGBHour * monthlyHours
  - Return breakdown with totalCost = cpuCost + memoryCost
- ecsCostToGeneric(breakdown: EcsCostBreakdown): GenericCostBreakdown
  - Transform to generic items array with 'vCPU Cost' and 'Memory Cost' labels
  - Return total

Use ECS_ARCHITECTURE_METADATA for pricing lookup.
Pure functions, no side effects, simple arithmetic like Lambda calculator.
  </action>
  <verify>npm run build succeeds, manual test with sample config returns expected costs</verify>
  <done>Calculator produces correct costs for x86 and ARM configurations</done>
</task>

<task type="auto">
  <name>Task 3: Create ECS configuration form with animated controls</name>
  <files>src/components/EcsConfigForm.tsx</files>
  <action>
Build config form following Lambda pattern:
- Props: EcsConfigFormProps with config, onChange, label
- Architecture radio buttons (x86 / ARM Graviton2) with description and savings note for ARM
- vCPU dropdown with ECS_VCPU_TIERS quick-select options (0.25-8 vCPU)
- Memory slider input (GB) with range 0.5-16 GB, dynamic max based on vCPU selection
- Monthly hours number input with default 730 (full month), range 1-730
- Real-time cost preview showing monthly cost below form

Apply interactiveControlVariants to all inputs for hover/focus animations.
Use motion.div wrapper with cardVariants for entrance animation.
Display memory limit warning if user exceeds vCPU's max memory (e.g., 0.25 vCPU max 2GB).
Add helper text explaining Fargate billing (per-second, billed for vCPU + memory).
  </action>
  <verify>Form renders without errors, all inputs update config correctly, animations smooth</verify>
  <done>Config form complete with validation, animations, and real-time feedback</done>
</task>

<task type="auto">
  <name>Task 4: Create ECS comparison page using generic framework</name>
  <files>src/components/EcsComparison.tsx</files>
  <action>
Create comparison page following Lambda pattern:
- Import ComparisonLayout, calculateEcsCosts, ecsCostToGeneric, EcsConfigForm
- Define default configs: configA = x86 1vCPU 2GB 730hrs, configB = ARM 1vCPU 2GB 730hrs
- Use ComparisonLayout with EcsConfig and EcsCostBreakdown generics
- Pass EcsConfigForm as FormComponent prop
- Pass calculateEcsCosts and ecsCostToGeneric as calculator/adapter
- ServiceSelector breadcrumb at top with 'ECS Fargate' title
- Page title: "ECS Fargate Cost Comparison"
- Description: "Compare AWS ECS Fargate costs between x86 and ARM Graviton2 architectures"

Default comparison showcases ARM savings (~20% cheaper) at identical vCPU/memory configuration.
  </action>
  <verify>npm run dev, navigate to /ecs, page renders comparison layout correctly</verify>
  <done>ECS comparison page functional with default configs showing ARM savings</done>
</task>

<task type="auto">
  <name>Task 5: Register ECS service in App routing and landing page</name>
  <files>src/App.tsx, src/components/LandingPage.tsx</files>
  <action>
Register ECS service following Lambda pattern:

**App.tsx:**
- Add EcsComparison import
- Add to services array: { id: 'ecs', name: 'ECS Fargate', path: '/ecs', Component: EcsComparison }
- Route automatically created by services.map()

**LandingPage.tsx:**
- Add ECS card to services array with:
  - id: 'ecs'
  - name: 'ECS Fargate'
  - icon: 'ðŸ“¦' (container emoji matching service theme)
  - description: 'Compare Fargate costs between x86 and ARM Graviton2 architectures'

Ensure both locations have matching service metadata for consistency.
  </action>
  <verify>npm run dev, landing page shows ECS card, clicking navigates to /ecs</verify>
  <done>ECS service accessible from landing page and routes correctly</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npm run build succeeds without errors or warnings
- [ ] npm run dev serves app, all pages load
- [ ] Landing page displays ECS card with container emoji
- [ ] /ecs route renders comparison page correctly
- [ ] Default comparison shows x86 vs ARM with ~20% savings for ARM
- [ ] Form inputs update configurations in real-time
- [ ] Cost breakdown displays vCPU cost and memory cost separately
- [ ] Animations smooth (card entrance, input hover/focus)
- [ ] No TypeScript errors, no console warnings
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- ECS service fully integrated following Lambda pattern
- Type-safe cost calculations with correct pricing
- Smooth animations consistent with existing services
- Default comparison demonstrates ARM Graviton2 cost savings
</success_criteria>

<output>
After completion, create `.planning/phases/06-ecs-service-integration/06-01-SUMMARY.md`:

# Phase 6 Plan 1: ECS Core Implementation Summary

**[Substantive one-liner - what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `src/types/ecs.ts` - Description
- `src/utils/ecsCalculator.ts` - Description
- `src/components/EcsConfigForm.tsx` - Description
- `src/components/EcsComparison.tsx` - Description
- `src/App.tsx` - Description
- `src/components/LandingPage.tsx` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Phase 6 complete. Ready for Phase 7 (Dark Mode Theme).
</output>
