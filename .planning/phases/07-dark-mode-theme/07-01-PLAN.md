---
phase: 07-dark-mode-theme
plan: 01
type: execute
---

<objective>
Implement dark mode with theme toggle, dark-optimized colors following Material Design guidelines, and persistent user preference.

Purpose: Provide users with a comfortable viewing experience in low-light environments while maintaining visual hierarchy and brand identity.
Output: Fully functional dark mode with toggle control, localStorage persistence, and seamless theme switching across all pages.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-phase.md
@./.claude/get-shit-done/templates/summary.md
@./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Current theme system
@src/index.css
@tailwind.config.js

# Prior phase summaries (relevant context)
@.planning/phases/01-design-foundation/01-01-SUMMARY.md

**Tech stack available:**
- Framer Motion 12.25.0 for animations
- Tailwind CSS 4.1.16 with @theme directive and CSS variables
- React 18.3.1 with hooks

**Established patterns:**
- CSS variables for theming using Tailwind v4 @theme
- Material Design color palettes and elevation system
- Declarative animations with Framer Motion variants

**Constraining decisions:**
- Material Design theme approach established in Phase 1
- Cost-specific semantic colors must maintain meaning in dark mode
- Responsive animation strategy with prefers-reduced-motion support
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dark theme color palette</name>
  <files>src/index.css</files>
  <action>
Add dark mode color variants following Material Design dark theme guidelines:
- Use .dark class selector approach (compatible with Tailwind v4)
- Dark backgrounds: elevated surfaces with subtle gradients (neutral-900 for base, neutral-800 for cards)
- Reduce color saturation in dark mode for visual comfort
- Maintain cost-specific semantic colors (savings=green, increase=red) with adjusted brightness
- Ensure proper contrast ratios (WCAG AA: 4.5:1 for text, 3:1 for UI elements)
- Dark mode shadows: lighter opacity, use colored shadows for depth
- Primary/secondary colors: use lighter variants (300-400 range) for better visibility on dark backgrounds

DO NOT use media queries for theme detection - theme will be controlled by .dark class on root element.
DO NOT change existing light mode colors - only add dark mode variants within .dark selector.
  </action>
  <verify>Build succeeds with npm run build, no CSS errors, dark color variables defined in .dark scope</verify>
  <done>All color variables have dark mode variants defined in src/index.css within .dark selector, build passes without errors</done>
</task>

<task type="auto">
  <name>Task 2: Implement theme context and toggle</name>
  <files>src/contexts/ThemeContext.tsx, src/components/ThemeToggle.tsx, src/main.tsx, src/components/LandingPage.tsx</files>
  <action>
Create theme management system:

1. **src/contexts/ThemeContext.tsx** (NEW):
   - Create ThemeContext with 'light' | 'dark' state
   - ThemeProvider component that:
     - Reads initial theme from localStorage (key: 'theme-preference')
     - Falls back to prefers-color-scheme media query if no stored preference
     - Applies/removes .dark class on document.documentElement
     - Saves preference to localStorage on change
   - Export useTheme hook for consuming theme state

2. **src/components/ThemeToggle.tsx** (NEW):
   - Icon-based toggle button (sun for light mode, moon for dark mode)
   - Use Framer Motion for smooth icon transition animation
   - Apply interactiveControlVariants from animations.ts for hover/tap feedback
   - Accessible: aria-label describing action ("Switch to dark mode" / "Switch to light mode")
   - Position: Fixed in top-right corner with elevated shadow

3. **src/main.tsx** (MODIFY):
   - Wrap App with ThemeProvider

4. **src/components/LandingPage.tsx** (MODIFY):
   - Add ThemeToggle component to page header

Why localStorage: Persists preference across sessions without requiring authentication.
Why .dark class: Standard approach compatible with Tailwind and allows manual control vs media query.
  </action>
  <verify>npm run dev succeeds, clicking toggle switches theme, localStorage updates ('theme-preference' key), .dark class toggles on html/documentElement, preference persists across page refresh</verify>
  <done>Theme toggle visible and functional, theme switches smoothly, preference persists in localStorage and survives refresh, respects prefers-color-scheme on first visit</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete dark mode implementation with toggle and persistent preference across all pages (Landing, S3, Aurora, Lambda, ECS comparisons)</what-built>
  <how-to-verify>
1. Run: npm run dev
2. Visit: http://localhost:5173
3. Toggle dark mode using the button in top-right corner
4. Check landing page appearance (cards, text, background)
5. Navigate to each service comparison page:
   - S3 Comparison
   - Aurora Comparison
   - Lambda Comparison
   - ECS Comparison
6. For each page, verify in both light and dark modes:
   - Configuration forms: inputs, labels, validation errors visible
   - Comparison charts: bars, axes, tooltips readable
   - Cost breakdowns: values, highlights, borders appropriate
   - Cards: shadows visible, elevation hierarchy maintained
   - Text: proper contrast, no hard-to-read sections
7. Refresh page: theme preference should persist
8. Check in browser DevTools: localStorage has 'theme-preference' key
9. Toggle back to light mode: everything returns to original appearance
10. Optional: Test in Chrome, Firefox, Safari if available
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any visual issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] npm run build succeeds without errors
- [ ] Theme toggle visible and functional on all pages
- [ ] Dark mode colors provide proper contrast and readability
- [ ] Theme preference persists across browser refreshes
- [ ] No visual regressions in light mode
- [ ] All services (S3, Aurora, Lambda, ECS) work correctly in both modes
- [ ] Cost-specific semantic colors maintain meaning in dark mode
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Dark theme applied consistently across entire application
- Theme toggle accessible and animated smoothly
- User preference persists using localStorage
- No accessibility issues introduced (contrast ratios maintained)
- Phase 7 complete, ready for Phase 8
</success_criteria>

<output>
After completion, create `.planning/phases/07-dark-mode-theme/07-01-SUMMARY.md`:

# Phase 7 Plan 1: Dark Mode Theme Summary

**[One-liner describing what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]
- [Key outcome 3]

## Files Created/Modified

- `src/index.css` - Dark theme color palette with Material Design dark theme guidelines
- `src/contexts/ThemeContext.tsx` - Theme state management with localStorage persistence
- `src/components/ThemeToggle.tsx` - Animated theme toggle component
- `src/main.tsx` - ThemeProvider integration
- `src/components/LandingPage.tsx` - ThemeToggle placement

## Decisions Made

[Document any implementation choices made during execution, or "None"]

## Issues Encountered

[Document any problems and resolutions, or "None"]

## Next Phase Readiness

Ready for Phase 8: Multi-Scenario Comparison & Export
</output>
